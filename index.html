<!DOCTYPE html>
<html lang="ja" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio | Matsuda Lab Student</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700;900&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background-color: #0f172a; /* slate-900 */
            color: #f8fafc; /* slate-50 */
            overflow-x: hidden;
        }

        /* --- カスタムカーソル装飾 --- */
        .cursor-outline {
            position: fixed;
            top: 0; left: 0;
            transform: translate(-50%, -50%);
            width: 40px; height: 40px;
            border: 2px solid rgba(56, 189, 248, 0.3);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            transition: width 0.2s, height 0.2s, background-color 0.2s;
        }
        body.hovering .cursor-outline {
            width: 60px; height: 60px;
            background-color: rgba(56, 189, 248, 0.1);
            border-color: transparent;
        }

        /* --- スクロールバー --- */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 5px; }

        /* --- アニメーション --- */
        .reveal {
            opacity: 0; transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.5, 0, 0, 1);
        }
        .reveal.active { opacity: 1; transform: translateY(0); }
        
        /* 3D Tilt */
        .tilt-card {
            transform-style: preserve-3d;
            transform: perspective(1000px);
        }
        /* 画像がない場合のフォールバック用スタイル */
        .img-fallback {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #1e293b;
            color: #64748b;
            font-size: 0.75rem;
            font-weight: bold;
            width: 100%;
            height: 100%;
            text-align: center;
            padding: 1rem;
        }

        /* モーダル */
        #modal-overlay { transition: opacity 0.3s ease; }
        #modal-content { transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.3s ease; }
        .modal-open #modal-content { transform: scale(1); opacity: 1; }
        .modal-closed #modal-content { transform: scale(0.95); opacity: 0; }

        /* タブ */
        .tab-btn.active {
            background-color: rgba(56, 189, 248, 0.2);
            color: #38bdf8;
            border-color: #38bdf8;
        }

        /* 表示モード切り替え */
        .view-section {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .hidden-view {
            display: none;
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body class="antialiased">

    <!-- カーソル装飾 -->
    <div class="cursor-outline"></div>
    
    <!-- 進捗バー -->
    <div id="progress-bar" class="fixed top-0 left-0 h-1 bg-gradient-to-r from-cyan-400 to-purple-600 z-50 transition-all duration-100" style="width: 0%"></div>

    <!-- ナビゲーション -->
    <nav class="fixed w-full z-40 top-0 left-0 backdrop-blur-md bg-slate-900/80 border-b border-white/5">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <a href="#" class="text-lg font-bold tracking-tighter flex items-center gap-2 hoverable">
                    <div class="w-3 h-3 bg-cyan-400 rounded-full"></div>
                    PORTFOLIO
                </a>
                <!-- モード切替スイッチ -->
                <div class="flex items-center bg-slate-800 rounded-full p-1 border border-slate-700 ml-4">
                    <button id="btn-creative" onclick="switchView('creative')" class="px-3 py-1 rounded-full text-xs font-bold bg-slate-700 text-white shadow-md transition-all hoverable">
                        <i class="ph-fill ph-paint-brush"></i> Creative
                    </button>
                    <button id="btn-resume" onclick="switchView('resume')" class="px-3 py-1 rounded-full text-xs font-bold text-slate-400 hover:text-white transition-all hoverable">
                        <i class="ph-fill ph-read-cv-logo"></i> Resume
                    </button>
                </div>
            </div>

            <div class="hidden md:flex space-x-6">
                <a href="#about" class="text-xs font-medium text-slate-300 hover:text-cyan-400 transition-colors hoverable">About</a>
                <a href="#skills" class="text-xs font-medium text-slate-300 hover:text-cyan-400 transition-colors hoverable">Skills</a>
                <a href="#works" class="text-xs font-medium text-slate-300 hover:text-cyan-400 transition-colors hoverable">Works</a>
            </div>
        </div>
    </nav>

    <!-- ========== CREATIVE VIEW (デフォルト) ========== -->
    <div id="creative-view" class="view-section">
        <!-- Hero Section -->
        <header class="relative min-h-screen flex items-center justify-center overflow-hidden pt-20">
            <!-- 背景装飾 -->
            <div class="absolute w-[500px] h-[500px] bg-blue-600 rounded-full top-0 left-0 opacity-20 blur-[90px] animate-pulse"></div>
            <div class="absolute w-[400px] h-[400px] bg-purple-600 rounded-full bottom-0 right-0 opacity-20 blur-[90px] animate-pulse" style="animation-delay: 2s;"></div>

            <div class="container mx-auto px-6 z-10 relative">
                <div class="max-w-4xl">
                    <p class="text-cyan-400 font-bold tracking-widest mb-4 reveal flex items-center gap-2">
                        <span class="w-8 h-[2px] bg-cyan-400 inline-block"></span>
                        ENGINEER PORTFOLIO
                    </p>
                    <h1 class="text-5xl md:text-7xl lg:text-8xl font-black mb-8 leading-tight reveal" style="transition-delay: 0.1s;">
                        技術で「体験」を<br>
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-600">拡張する。</span>
                    </h1>
                    <p class="text-lg md:text-xl text-slate-400 max-w-2xl mb-10 reveal leading-relaxed" style="transition-delay: 0.2s;">
                        情報系学部3年 / 松田研究室（情報の可視化）。<br>
                        Unity, Flutter, Python, 3Dモデリング。<br>
                        <span class="text-white font-bold">「作りたいもの」</span>に合わせて技術を習得する探求心で、9本のプロジェクトを実装。
                    </p>
                    <div class="flex flex-wrap gap-4 reveal" style="transition-delay: 0.3s;">
                        <button onclick="document.getElementById('works').scrollIntoView()" class="group relative px-8 py-3 rounded-full bg-blue-600 text-white font-bold overflow-hidden hoverable inline-block">
                            <span class="relative z-10 group-hover:text-white transition-colors">View Projects</span>
                            <div class="absolute inset-0 h-full w-full bg-gradient-to-r from-cyan-500 to-blue-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Works Section (Creative) -->
        <section id="works" class="py-32 bg-slate-900 relative min-h-screen">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12 reveal">
                    <h2 class="text-sm text-cyan-400 font-bold tracking-widest mb-2">WORKS</h2>
                    <h3 class="text-4xl font-bold mb-8">制作実績</h3>
                    
                    <!-- フィルタータブ -->
                    <div class="flex flex-wrap justify-center gap-4 mb-12">
                        <button class="tab-btn active px-5 py-2 rounded-full border border-slate-700 text-slate-400 hover:text-white hover:border-slate-500 transition-all text-sm font-bold hoverable" data-filter="all">All</button>
                        <button class="tab-btn px-5 py-2 rounded-full border border-slate-700 text-slate-400 hover:text-white hover:border-slate-500 transition-all text-sm font-bold hoverable" data-filter="vr">VR / Game</button>
                        <button class="tab-btn px-5 py-2 rounded-full border border-slate-700 text-slate-400 hover:text-white hover:border-slate-500 transition-all text-sm font-bold hoverable" data-filter="app">Web / App / AI</button>
                        <button class="tab-btn px-5 py-2 rounded-full border border-slate-700 text-slate-400 hover:text-white hover:border-slate-500 transition-all text-sm font-bold hoverable" data-filter="model">3D Model</button>
                    </div>
                </div>

                <!-- Works Grid (JSで生成) -->
                <div id="works-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 reveal">
                    <!-- JS Injected -->
                </div>
            </div>
        </section>
    </div>

    <!-- ========== RESUME VIEW (企業向け・一覧) ========== -->
    <div id="resume-view" class="view-section hidden-view pt-24 pb-20 bg-slate-900">
        <div class="container mx-auto px-6 max-w-5xl">
            
            <!-- ヘッダー情報 -->
            <div class="border-b border-slate-700 pb-8 mb-12">
                <h1 class="text-3xl font-bold mb-4">Resume / Curriculum Vitae</h1>
                <div class="flex flex-wrap gap-6 text-slate-400 text-sm">
                    <p><i class="ph-bold ph-student"></i> 情報系学部 3年 (松田研究室)</p>
                    <p><i class="ph-bold ph-lightning"></i> 第二種電気工事士</p>
                    <p><i class="ph-bold ph-map-pin"></i> 志望職種: エンジニア / テクニカルアーティスト</p>
                </div>
            </div>

            <!-- スキルマトリックス -->
            <section class="mb-16">
                <h2 class="text-xl font-bold text-cyan-400 mb-6 flex items-center gap-2">
                    <i class="ph-fill ph-chart-bar"></i> 技術スタック・経験年数
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- 左カラム -->
                    <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                        <h3 class="font-bold mb-4 text-white">Development</h3>
                        <table class="w-full text-sm text-left text-slate-300">
                            <thead class="text-xs text-slate-500 uppercase bg-slate-800">
                                <tr>
                                    <th class="px-2 py-2">Language/Tool</th>
                                    <th class="px-2 py-2">Years</th>
                                    <th class="px-2 py-2">Level</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-700">
                                <tr><td class="px-2 py-3">Unity (C#)</td><td class="px-2">3年</td><td class="px-2">★★★★★ (Main)</td></tr>
                                <tr><td class="px-2 py-3">HTML/CSS/JS</td><td class="px-2">2年</td><td class="px-2">★★★★☆</td></tr>
                                <tr><td class="px-2 py-3">Flutter (Dart)</td><td class="px-2">1年</td><td class="px-2">★★★★☆</td></tr>
                                <tr><td class="px-2 py-3">Python (ML)</td><td class="px-2">0.5年</td><td class="px-2">★★★☆☆</td></tr>
                                <tr><td class="px-2 py-3">Java (Android)</td><td class="px-2">-</td><td class="px-2">★★★☆☆</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- 右カラム -->
                    <div class="bg-slate-800/50 rounded-lg p-6 border border-slate-700">
                        <h3 class="font-bold mb-4 text-white">3D / Design / Hardware</h3>
                        <table class="w-full text-sm text-left text-slate-300">
                            <thead class="text-xs text-slate-500 uppercase bg-slate-800">
                                <tr>
                                    <th class="px-2 py-2">Tool</th>
                                    <th class="px-2 py-2">Years</th>
                                    <th class="px-2 py-2">Note</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-700">
                                <tr><td class="px-2 py-3">Maya</td><td class="px-2">3年</td><td class="px-2">モデリング/アニメーション</td></tr>
                                <tr><td class="px-2 py-3">Blender</td><td class="px-2">1年</td><td class="px-2">基本操作可</td></tr>
                                <tr><td class="px-2 py-3">Fusion 360</td><td class="px-2">1年</td><td class="px-2">CAD設計</td></tr>
                                <tr><td class="px-2 py-3">Raspberry Pi</td><td class="px-2">-</td><td class="px-2">電子工作経験あり</td></tr>
                                <tr><td class="px-2 py-3">電気工事士2種</td><td class="px-2">-</td><td class="px-2">有資格</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- プロジェクトリスト (テーブル形式) -->
            <section>
                <h2 class="text-xl font-bold text-cyan-400 mb-6 flex items-center gap-2">
                    <i class="ph-fill ph-list-checks"></i> プロジェクト実績一覧
                </h2>
                <div class="overflow-x-auto bg-slate-800/50 rounded-lg border border-slate-700">
                    <table class="w-full text-sm text-left text-slate-300">
                        <thead class="text-xs text-slate-500 uppercase bg-slate-800">
                            <tr>
                                <th class="px-6 py-3">Project Name</th>
                                <th class="px-6 py-3">Type</th>
                                <th class="px-6 py-3">Tech Stack</th>
                                <th class="px-6 py-3">Role / Achievement</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-700" id="resume-table-body">
                            <!-- JS Injected -->
                        </tbody>
                    </table>
                </div>
            </section>
        </div>
    </div>

    <!-- 詳細モーダル -->
    <div id="modal-overlay" class="fixed inset-0 bg-slate-900/90 backdrop-blur-sm z-[100] hidden opacity-0 flex items-center justify-center p-4 cursor-auto" onclick="closeModal()">
        <div id="modal-content" class="bg-slate-800 border border-white/10 rounded-3xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl transform scale-95 opacity-0" onclick="event.stopPropagation()">
            <button onclick="closeModal()" class="absolute top-4 right-4 w-10 h-10 bg-slate-700/50 rounded-full flex items-center justify-center text-white hover:bg-slate-700 transition-colors hoverable z-10">
                <i class="ph-bold ph-x"></i>
            </button>
            
            <div class="flex flex-col lg:flex-row">
                <!-- 画像エリア: 画像がない場合はグレー背景になるようスタイル設定 -->
                <div class="lg:w-2/5 h-64 lg:h-auto relative bg-black flex items-center justify-center overflow-hidden">
                    <img id="modal-img" src="" alt="Project Image" class="w-full h-full object-contain" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <!-- フォールバック用 -->
                    <div class="hidden w-full h-full absolute inset-0 flex flex-col items-center justify-center bg-slate-800 text-slate-500 p-4 text-center">
                        <i class="ph-duotone ph-image text-4xl mb-2"></i>
                        <span class="text-xs">No Image<br>./images/filename.jpg</span>
                    </div>
                </div>
                
                <div class="lg:w-3/5 p-8 lg:p-10">
                    <div id="modal-tags" class="flex flex-wrap gap-2 mb-4"></div>
                    <h3 id="modal-title" class="text-3xl font-bold mb-2 text-white"></h3>
                    <p id="modal-subtitle" class="text-cyan-400 text-sm font-bold mb-6"></p>
                    
                    <div class="space-y-6 text-slate-300 text-sm leading-relaxed">
                        <div>
                            <h4 class="text-white font-bold mb-2 flex items-center gap-2"><i class="ph-fill ph-info"></i> 概要</h4>
                            <p id="modal-desc"></p>
                        </div>
                        <div>
                            <h4 class="text-white font-bold mb-2 flex items-center gap-2"><i class="ph-fill ph-lightbulb"></i> 技術的アプローチ</h4>
                            <p id="modal-tech"></p>
                        </div>
                        <div class="bg-slate-900/50 p-4 rounded-xl border border-white/5">
                            <h4 class="text-white font-bold mb-2 text-xs uppercase tracking-wider">使用技術</h4>
                            <div id="modal-stack" class="flex flex-wrap gap-2"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        /* * 【重要】画像の差し替えについて
         * index.htmlと同じ階層に「images」というフォルダを作成し、
         * その中に以下のファイル名で画像を保存してください。
         */
        const projects = [
            {
                id: 1,
                title: "VR対応型 FPSゲーム",
                category: "vr",
                subtitle: "県プロコン「優良賞」受賞 / 代表作",
                image: "./images/vr_fps.png", // 画像パス
                desc: "Meta Quest 2を使用した、最大6人対戦可能なVRシューティング。ローカルネットワーク対戦に対応。",
                techDetails: "VR酔い防止のためフレームレート維持を最優先。オブジェクトのローポリ化とカリング処理を独自調整。Mayaで自作した武器モデルのアニメーション制御も担当。",
                stack: ["Unity", "C#", "Maya", "Oculus Integration", "Photon"],
                role: "PM / Lead Dev / Modeling"
            },
            {
                id: 10,
                title: "学内最短経路ナビゲーター",
                category: "app",
                subtitle: "Python学習 / 機械学習 / 学内ツール",
                image: "./images/python_nav.png", // 画像パス
                desc: "キャンパス内の現在地と目的地を入力すると、混雑状況を予測して最短経路を提示するシステム。",
                techDetails: "Python (NetworkX) でダイクストラ法を実装。過去の混雑データをscikit-learnで学習させ、時間帯による重み付けを動的に変更するロジックを組み込みました。",
                stack: ["Python", "scikit-learn", "NetworkX", "Pandas"],
                role: "Solo Dev (6ヶ月)"
            },
            {
                id: 3,
                title: "MailTalk",
                category: "app",
                subtitle: "モバイルアプリ / UI UX",
                image: "./images/mailtalk.png", // 画像パス
                desc: "メールをチャット形式（吹き出し）で表示・管理できるアプリ。",
                techDetails: "Flutterでのクロスプラットフォーム開発。IMAPプロトコル解析と独自パーサーにより、メール本文から署名などを除去して整形表示。",
                stack: ["Flutter", "Dart", "IMAP", "UI Design"],
                role: "Solo Dev"
            },
            {
                id: 4,
                title: "Wikipedia Golf",
                category: "app",
                subtitle: "ブラウザゲーム / API連携",
                image: "./images/wiki_golf.png", // 画像パス
                desc: "リンクを辿りゴールを目指すWebゲーム。",
                techDetails: "MediaWiki APIと非同期通信(fetch)を利用。動的なDOM生成によるSPA。",
                stack: ["JavaScript", "HTML/CSS", "Wikipedia API"],
                role: "Solo Dev"
            },
            {
                id: 5,
                title: "NewDealPoker",
                category: "app",
                subtitle: "Webゲーム / リアルタイム通信",
                image: "./images/poker_game.png", // 画像パス
                desc: "エクイティ分配導入の新ルールポーカー。",
                techDetails: "WebSocketでのリアルタイム同期。役判定ロジックを自作。",
                stack: ["JavaScript", "WebSocket", "Node.js"],
                role: "Solo Dev"
            },
            {
                id: 6,
                title: "地域助け合いアプリ",
                category: "app",
                subtitle: "マッチングアプリ / ユニバーサルデザイン",
                image: "./images/region_app.png", // 画像パス
                desc: "「手伝って」をマッチング。高齢者向けデザイン。",
                techDetails: "Firebase Firestoreバックエンド。アクセシビリティ対応。",
                stack: ["Flutter", "Firebase"],
                role: "Solo Dev"
            },
            {
                id: 7,
                title: "駅〜大学間バス時刻表",
                category: "app",
                subtitle: "大学生向けツール / Unity UI",
                image: "./images/bus_schedule.png", // 画像パス
                desc: "次のバスまでの時間を可視化するデジタルサイネージ風ツール。",
                techDetails: "Unity uGUI使用。CSVインポート機能でダイヤ改正に対応。",
                stack: ["Unity", "C#", "uGUI"],
                role: "Solo Dev"
            },
            {
                id: 8,
                title: "PCペット育成ゲーム",
                category: "vr",
                subtitle: "デスクトップマスコット",
                image: "./images/pc_pet.png", // 画像パス
                desc: "デスクトップ常駐型の癒やし系育成ゲーム。",
                techDetails: "Windows API制御で背景透過ウィンドウを実現。",
                stack: ["Unity", "C#", "Windows API"],
                role: "Solo Dev"
            },
            {
                id: 9,
                title: "教室再現プロジェクト",
                category: "model",
                subtitle: "3Dモデリング / 空間再現",
                image: "./images/classroom.png", // 画像パス
                desc: "高校の教室を3DCGで完全再現。",
                techDetails: "Fusion 360で寸法モデリング、Mayaで質感設定。",
                stack: ["Maya", "Fusion 360", "Photoshop"],
                role: "Modeling"
            }
        ];

        // --- ビュー切り替えロジック ---
        function switchView(mode) {
            const creativeView = document.getElementById('creative-view');
            const resumeView = document.getElementById('resume-view');
            const btnCreative = document.getElementById('btn-creative');
            const btnResume = document.getElementById('btn-resume');
            
            if (mode === 'creative') {
                creativeView.classList.remove('hidden-view');
                resumeView.classList.add('hidden-view');
                
                btnCreative.classList.replace('text-slate-400', 'text-white');
                btnCreative.classList.add('bg-slate-700', 'shadow-md');
                btnCreative.classList.remove('hover:text-white');
                
                btnResume.classList.replace('text-white', 'text-slate-400');
                btnResume.classList.remove('bg-slate-700', 'shadow-md');
                btnResume.classList.add('hover:text-white');
                
                setTimeout(() => { window.dispatchEvent(new Event('scroll')); }, 100);
            } else {
                creativeView.classList.add('hidden-view');
                resumeView.classList.remove('hidden-view');

                btnResume.classList.replace('text-slate-400', 'text-white');
                btnResume.classList.add('bg-slate-700', 'shadow-md');
                btnResume.classList.remove('hover:text-white');
                
                btnCreative.classList.replace('text-white', 'text-slate-400');
                btnCreative.classList.remove('bg-slate-700', 'shadow-md');
                btnCreative.classList.add('hover:text-white');
                
                window.scrollTo(0, 0);
            }
        }

        // --- Works Grid 生成 (Creative Mode) ---
        const worksGrid = document.getElementById('works-grid');
        const tabBtns = document.querySelectorAll('.tab-btn');

        function renderProjects(filter = 'all') {
            worksGrid.innerHTML = '';
            
            const filteredProjects = filter === 'all' 
                ? projects 
                : projects.filter(p => p.category === filter);

            filteredProjects.forEach((p, index) => {
                const delay = index * 50;
                const card = document.createElement('div');
                card.className = `tilt-card bg-slate-800/30 rounded-2xl border border-white/5 overflow-hidden hover:border-cyan-500/30 transition-all group cursor-pointer hoverable`;
                card.style.animation = `fadeIn 0.5s ease forwards ${delay}ms`;
                card.setAttribute('onclick', `openModal(${p.id})`);
                
                // 画像読み込みエラー時の処理 (onerror) を追加
                card.innerHTML = `
                    <div class="h-48 overflow-hidden relative">
                        <img src="${p.image}" 
                             alt="${p.title}" 
                             class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        
                        <!-- 画像なしフォールバック -->
                        <div class="img-fallback hidden w-full h-full absolute inset-0 flex-col items-center justify-center text-slate-500 bg-slate-800">
                            <i class="ph-duotone ph-image text-4xl mb-2"></i>
                            <span class="text-xs font-mono">./images/<br>${p.image.split('/').pop()}</span>
                        </div>

                        <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-slate-900 to-transparent p-4 pt-12">
                           <span class="text-xs font-bold text-cyan-400 uppercase tracking-wider mb-1 block">${p.category === 'model' ? '3D Model' : p.stack[0]}</span>
                        </div>
                    </div>
                    <div class="p-5 relative bg-slate-900 h-full">
                        <h4 class="text-lg font-bold mb-1 text-white group-hover:text-cyan-400 transition-colors line-clamp-1">${p.title}</h4>
                        <p class="text-slate-400 text-xs mb-3 border-b border-white/10 pb-2 line-clamp-1">${p.subtitle}</p>
                        <div class="flex flex-wrap gap-1.5 text-[10px] text-slate-500 font-mono">
                            ${p.stack.slice(0,3).map(s => `<span class="bg-slate-800 px-2 py-0.5 rounded border border-slate-700">${s}</span>`).join('')}
                        </div>
                    </div>
                `;
                card.addEventListener('mousemove', handleTilt);
                card.addEventListener('mouseleave', resetTilt);
                worksGrid.appendChild(card);
            });
            updateHoverables();
        }

        // --- Resume Table 生成 ---
        const resumeTableBody = document.getElementById('resume-table-body');
        function renderResumeTable() {
            let html = '';
            projects.forEach(p => {
                html += `
                    <tr class="hover:bg-slate-700/50 transition-colors cursor-pointer" onclick="openModal(${p.id})">
                        <td class="px-6 py-4 font-medium text-white whitespace-nowrap">${p.title}</td>
                        <td class="px-6 py-4 text-xs uppercase tracking-wider text-slate-400">${p.category}</td>
                        <td class="px-6 py-4">${p.stack.join(', ')}</td>
                        <td class="px-6 py-4 text-slate-400">${p.role} / ${p.desc.substring(0, 30)}...</td>
                    </tr>
                `;
            });
            resumeTableBody.innerHTML = html;
        }

        // --- 初期化 ---
        renderProjects();
        renderResumeTable();

        // --- フィルター制御 ---
        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                tabBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                renderProjects(btn.dataset.filter);
            });
        });

        // --- UI/Interaction Logic ---
        function handleTilt(e) {
            const rect = this.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            const centerX = rect.width / 2;
            const centerY = rect.height / 2;
            const rotateX = ((y - centerY) / centerY) * -5;
            const rotateY = ((x - centerX) / centerX) * 5;
            this.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.02, 1.02, 1.02)`;
        }
        function resetTilt() {
            this.style.transform = `perspective(1000px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)`;
        }

        // Modal Logic
        const modalOverlay = document.getElementById('modal-overlay');
        window.openModal = function(id) {
            const p = projects.find(proj => proj.id === id);
            if (!p) return;

            // 画像セット (エラー処理込み)
            const modalImg = document.getElementById('modal-img');
            const modalFallback = modalImg.nextElementSibling;
            modalImg.style.display = 'block';
            modalFallback.style.display = 'none';
            modalImg.src = p.image;
            
            document.getElementById('modal-title').innerText = p.title;
            document.getElementById('modal-subtitle').innerText = p.subtitle;
            document.getElementById('modal-desc').innerText = p.desc;
            document.getElementById('modal-tech').innerText = p.techDetails;
            
            const stackContainer = document.getElementById('modal-stack');
            stackContainer.innerHTML = p.stack.map(s => 
                `<span class="px-3 py-1 rounded bg-slate-700 text-cyan-300 text-xs border border-slate-600">${s}</span>`
            ).join('');
            
            const tagContainer = document.getElementById('modal-tags');
            tagContainer.innerHTML = `<span class="px-2 py-1 rounded bg-cyan-500/20 text-cyan-400 text-xs font-bold border border-cyan-500/20 uppercase">${p.category}</span>`;

            modalOverlay.classList.remove('hidden');
            requestAnimationFrame(() => {
                modalOverlay.classList.remove('opacity-0');
                modalOverlay.classList.add('modal-open');
                modalOverlay.classList.remove('modal-closed');
                document.body.style.overflow = 'hidden';
            });
        };
        window.closeModal = function() {
            modalOverlay.classList.remove('modal-open');
            modalOverlay.classList.add('modal-closed');
            modalOverlay.classList.add('opacity-0');
            setTimeout(() => {
                modalOverlay.classList.add('hidden');
                document.body.style.overflow = '';
            }, 300);
        };

        // Cursor & Reveal
        const cursorOutline = document.querySelector('.cursor-outline');
        window.addEventListener('mousemove', (e) => {
            cursorOutline.style.left = `${e.clientX}px`;
            cursorOutline.style.top = `${e.clientY}px`;
        });
        function updateHoverables() {
            document.querySelectorAll('.hoverable').forEach(el => {
                el.addEventListener('mouseenter', () => document.body.classList.add('hovering'));
                el.addEventListener('mouseleave', () => document.body.classList.remove('hovering'));
            });
        }
        updateHoverables();

        const revealObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) entry.target.classList.add('active');
            });
        }, { threshold: 0.1 });
        document.querySelectorAll('.reveal').forEach(el => revealObserver.observe(el));

        window.addEventListener('scroll', () => {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById("progress-bar").style.width = scrolled + "%";
        });
    </script>
</body>
</html>